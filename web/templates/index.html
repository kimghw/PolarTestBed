<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë§ˆí¬ë‹¤ìš´ ë ˆë²¨ ë³€í™˜ê¸°</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .header p {
            font-size: 1.1em;
            opacity: 0.9;
        }

        .content {
            padding: 30px;
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .top-controls {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 12px;
            align-items: start;
        }

        .main-layout {
            display: grid;
            grid-template-columns: 280px 1fr;
            gap: 20px;
        }

        .control-panel {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            height: fit-content;
            position: sticky;
            top: 20px;
        }

        .control-group {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .control-item {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .control-item label {
            font-weight: 600;
            color: #333;
            font-size: 14px;
        }

        .control-item-row {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .control-item select,
        .control-item input[type="text"],
        .control-item-row select,
        .control-item-row input[type="text"] {
            padding: 8px 12px;
            border: 2px solid #ddd;
            border-radius: 5px;
            font-size: 14px;
            transition: border-color 0.3s;
            width: 100%;
        }

        .control-item select,
        .control-item-row select {
            cursor: pointer;
        }

        .control-item select:hover,
        .control-item input[type="text"]:focus,
        .control-item-row select:hover,
        .control-item-row input[type="text"]:focus {
            border-color: #667eea;
        }

        .control-item input[type="text"],
        .control-item-row input[type="text"] {
            font-family: 'Consolas', 'Monaco', monospace;
        }

        .control-item input[type="text"]:focus,
        .control-item-row input[type="text"]:focus {
            outline: none;
        }

        .exclude-levels {
            display: flex;
            gap: 15px;
            align-items: center;
            padding: 10px;
            background: #fff;
            border-radius: 5px;
            border: 2px solid #ddd;
        }

        .exclude-levels label {
            display: flex;
            align-items: center;
            gap: 5px;
            cursor: pointer;
            font-weight: normal;
            color: #555;
        }

        .exclude-levels input[type="checkbox"] {
            cursor: pointer;
            width: 18px;
            height: 18px;
        }

        .exclude-levels input[type="checkbox"]:checked + span {
            color: #667eea;
            font-weight: 600;
        }

        .btn {
            padding: 10px 25px;
            border: none;
            border-radius: 5px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-convert {
            background: #667eea;
            color: white;
        }

        .btn-convert:hover {
            background: #5568d3;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .btn-download {
            background: #28a745;
            color: white;
        }

        .btn-download:hover {
            background: #218838;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(40, 167, 69, 0.4);
        }

        .btn-copy {
            background: #17a2b8;
            color: white;
        }

        .btn-copy:hover {
            background: #138496;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(23, 162, 184, 0.4);
        }

        .btn-clear {
            background: #6c757d;
            color: white;
        }

        .btn-clear:hover {
            background: #5a6268;
        }

        .btn-upload {
            background: #ffc107;
            color: #333;
            cursor: pointer;
        }

        .btn-upload:hover {
            background: #ffb300;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(255, 193, 7, 0.4);
        }

        .btn-trim {
            background: #17a2b8;
            color: white;
        }

        .btn-trim:hover {
            background: #138496;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(23, 162, 184, 0.4);
        }

        .right-panel {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .editor-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        .editor-panel {
            display: flex;
            flex-direction: column;
            position: relative;
        }

        .editor-panel h3 {
            color: #333;
            margin-bottom: 10px;
            padding-bottom: 10px;
            border-bottom: 3px solid #667eea;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .copy-icon {
            background: #17a2b8;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 5px;
        }

        .copy-icon:hover {
            background: #138496;
            transform: scale(1.05);
            box-shadow: 0 3px 10px rgba(23, 162, 184, 0.4);
        }

        .copy-icon.success {
            background: #28a745 !important;
        }

        textarea {
            width: 100%;
            height: 500px;
            padding: 15px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 14px;
            resize: vertical;
            transition: border-color 0.3s;
        }

        textarea:focus {
            outline: none;
            border-color: #667eea;
        }

        .info-box {
            background: #e7f3ff;
            padding: 15px;
            border-radius: 8px;
            margin-top: 20px;
            border-left: 4px solid #667eea;
        }

        .info-box h4 {
            color: #667eea;
            margin-bottom: 10px;
        }

        .info-box ul {
            margin-left: 20px;
            color: #333;
        }

        .info-box li {
            margin: 5px 0;
        }

        .action-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-bottom: 15px;
        }

        .action-buttons .btn {
            flex: 1;
            min-width: 100px;
        }

        .tabs {
            display: flex;
            gap: 5px;
            border-bottom: 2px solid #ddd;
            margin-bottom: 15px;
        }

        .tab {
            padding: 10px 20px;
            background: #e9ecef;
            border: none;
            border-radius: 5px 5px 0 0;
            cursor: pointer;
            font-weight: 600;
            color: #666;
            transition: all 0.3s;
        }

        .tab:hover {
            background: #dee2e6;
        }

        .tab.active {
            background: #667eea;
            color: white;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .collapsible-section {
            margin-bottom: 10px;
        }

        .collapsible-header {
            background: #667eea;
            color: white;
            padding: 10px 15px;
            border-radius: 5px;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-weight: 600;
            transition: background 0.3s;
            user-select: none;
        }

        .collapsible-header:hover {
            background: #5568d3;
        }

        .collapsible-header .arrow {
            transition: transform 0.3s;
            font-size: 12px;
        }

        .collapsible-header.collapsed .arrow {
            transform: rotate(-90deg);
        }

        .collapsible-content {
            max-height: 1000px;
            overflow: hidden;
            transition: max-height 0.3s ease-out, padding 0.3s ease-out;
            padding: 15px 10px;
        }

        .collapsible-content.collapsed {
            max-height: 0;
            padding: 0 10px;
        }

        @media (max-width: 1200px) {
            .content {
                grid-template-columns: 1fr;
            }

            .control-panel {
                position: static;
            }

            .editor-container {
                grid-template-columns: 1fr;
            }

            .header h1 {
                font-size: 1.8em;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ“ ë§ˆí¬ë‹¤ìš´ ë ˆë²¨ ë³€í™˜ê¸°</h1>
            <p>ëª©ì°¨ êµ¬ì¡°ë¥¼ ì›í•˜ëŠ” í—¤ë”© ë ˆë²¨ë¡œ ìë™ ë³€í™˜</p>
        </div>

        <div class="content">
            <!-- ìƒë‹¨ ì»¨íŠ¸ë¡¤ ì˜ì—­ -->
            <div class="top-controls">
                <!-- ì•¡ì…˜ ë²„íŠ¼ ì˜ì—­ -->
                <div style="display: flex; gap: 10px; grid-column: 1 / -1;">
                    <label for="fileInput" class="btn btn-upload" style="flex: 1; margin: 0; text-align: center;">ğŸ“ íŒŒì¼ ì—´ê¸°</label>
                    <input type="file" id="fileInput" accept=".md,.markdown,.txt" style="display: none;" onchange="loadFile(this)">
                    <button class="btn btn-convert" onclick="convertText()" style="flex: 1;">ğŸ”„ ë³€í™˜</button>
                    <button class="btn btn-download" onclick="downloadFile()" style="flex: 1;">â¬‡ï¸ ë‹¤ìš´ë¡œë“œ</button>
                    <button class="btn btn-clear" onclick="clearAll()" style="flex: 1;">ğŸ—‘ï¸ ì´ˆê¸°í™”</button>
                </div>

                <div style="grid-column: 1 / -1;">
                    <span id="fileName" style="color: #666; font-size: 12px; display: block;"></span>
                </div>

                <div class="collapsible-section" style="grid-column: 1 / -1;">
                    <div class="collapsible-header" onclick="toggleCollapse(this)">
                        <span>âš™ï¸ ì¶œë ¥ ì„¤ì •</span>
                        <span class="arrow">â–¼</span>
                    </div>
                    <div class="collapsible-content">
                        <div style="display: flex; flex-direction: column; gap: 10px;">
                            <div style="display: flex; gap: 15px; align-items: center;">
                                <label for="outputLevel" style="min-width: 100px; font-weight: 600;">ì¶œë ¥ ì‹œì‘ ë ˆë²¨:</label>
                                <select id="outputLevel" style="flex: 1;">
                                    <option value="1"># (ë ˆë²¨ 1)</option>
                                    <option value="2">## (ë ˆë²¨ 2)</option>
                                    <option value="3" selected>### (ë ˆë²¨ 3)</option>
                                    <option value="4">#### (ë ˆë²¨ 4)</option>
                                    <option value="5">##### (ë ˆë²¨ 5)</option>
                                    <option value="6">###### (ë ˆë²¨ 6)</option>
                                </select>
                                <label for="suffix" style="min-width: 90px; font-weight: 600;">ë§ˆí¬ ë’¤ ì¶”ê°€:</label>
                                <input type="text" id="suffix" placeholder="ì˜ˆ: â–¶, >>" title="ë§ˆí¬ë‹¤ìš´ # ë’¤ì— ì¶”ê°€í•  ê³µë°±ì´ë‚˜ ì‹¬ë³¼" style="flex: 1; padding: 8px 12px; border: 2px solid #ddd; border-radius: 5px;">
                            </div>

                            <div style="display: flex; gap: 15px; align-items: center;">
                                <label for="removeChars" style="min-width: 90px; font-weight: 600;">íŠ¹ìˆ˜ë¬¸ì ì œê±°:</label>
                                <input type="text" id="removeChars" placeholder="ì˜ˆ: ()[]{}Â·/" title="ë³€í™˜ í›„ ì œëª©ì—ì„œ ì œê±°í•  íŠ¹ìˆ˜ë¬¸ì" style="flex: 1; padding: 8px 12px; border: 2px solid #ddd; border-radius: 5px; font-family: 'Consolas', 'Monaco', monospace;">
                            </div>

                            <div style="display: flex; gap: 15px; align-items: center;">
                                <label style="min-width: 100px; font-weight: 600;">ì œì™¸ ë ˆë²¨:</label>
                                <div class="exclude-levels" style="flex: 1;">
                                    <label title="ë ˆë²¨ 1 ì œì™¸">
                                        <input type="checkbox" id="excludeLevel1" value="level1">
                                        <span>#</span>
                                    </label>
                                    <label title="ë ˆë²¨ 2 ì œì™¸">
                                        <input type="checkbox" id="excludeLevel2" value="level2">
                                        <span>##</span>
                                    </label>
                                    <label title="ë ˆë²¨ 3 ì œì™¸">
                                        <input type="checkbox" id="excludeLevel3" value="level3">
                                        <span>###</span>
                                    </label>
                                    <label title="ë ˆë²¨ 4 ì œì™¸">
                                        <input type="checkbox" id="excludeLevel4" value="level4">
                                        <span>####</span>
                                    </label>
                                    <label title="ë ˆë²¨ 5 ì œì™¸">
                                        <input type="checkbox" id="excludeLevel5" value="level5">
                                        <span>#####</span>
                                    </label>
                                    <label title="ë ˆë²¨ 6 ì œì™¸">
                                        <input type="checkbox" id="excludeLevel6" value="level6">
                                        <span>######</span>
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ë©”ì¸ ë ˆì´ì•„ì›ƒ (ì™¼ìª½ íŒ¨ë„ + ì˜¤ë¥¸ìª½ ì—ë””í„°) -->
            <div class="main-layout">
                <div class="control-panel">
                <div class="tabs">
                    <button class="tab active" onclick="switchTab('pattern')">íŒ¨í„´ ì„¤ì •</button>
                    <button class="tab" onclick="switchTab('guide')">ì •ê·œì‹ ê°€ì´ë“œ</button>
                </div>

                <div id="pattern-tab" class="tab-content active">
                <div class="control-group">

                    <div class="collapsible-section">
                        <div class="collapsible-header" onclick="toggleCollapse(this)">
                            <span>ğŸ¯ íŒ¨í„´ ì„¤ì •</span>
                            <span class="arrow">â–¼</span>
                        </div>
                        <div class="collapsible-content">
                        <div style="display: flex; flex-direction: column; gap: 12px;">

                    <div class="control-item">
                        <label for="level1Pattern">ë ˆë²¨ 1 íŒ¨í„´:</label>
                        <div class="control-item-row">
                            <select id="level1Pattern" style="flex: 1;">
                                <option value="">ì„ íƒ ì•ˆí•¨</option>
                                <option value="^###\s+" selected>### (3ê°œ #)</option>
                                <option value="^####\s+">#### (4ê°œ #)</option>
                                <option value="^##\s+">## (2ê°œ #)</option>
                                <option value="^#\s+"># (1ê°œ #)</option>
                                <option value="^\d+\.\s+">ìˆ«ì. (1., 2.)</option>
                                <option value="^ì œ\d+ì¥\s+">ì œNì¥ (ì œ1ì¥, ì œ2ì¥)</option>
                                <option value="^ì œ\d+ì ˆ\s+">ì œNì ˆ (ì œ1ì ˆ, ì œ2ì ˆ)</option>
                                <option value="^\*\*\s*">** (ë³„í‘œ 2ê°œ)</option>
                                <option value="^[A-Z]\.\s+">ëŒ€ë¬¸ì. (A., B.)</option>
                                <option value="^[IVX]+\.\s+">ë¡œë§ˆìˆ«ì. (I., II.)</option>
                                <option value="^[a-z]\)\s+">ì†Œë¬¸ì) (a), b))</option>
                                <option value="^\(\d+\)\s+">ê´„í˜¸ìˆ«ì ((1), (2))</option>
                                <option value="custom">ì§ì ‘ ì…ë ¥</option>
                            </select>
                        </div>
                        <input type="text" id="level1Custom" placeholder="ì •ê·œì‹ ì…ë ¥" style="display:none;">
                        <div style="display: flex; gap: 10px; margin-top: 5px; font-size: 13px;">
                            <label style="display: flex; align-items: center; gap: 5px; cursor: pointer;">
                                <input type="checkbox" id="level1Space1" onchange="updatePatternWithSpaces('level1')">
                                <span>ê³µë°± 1ê°œ í—ˆìš©</span>
                            </label>
                            <label style="display: flex; align-items: center; gap: 5px; cursor: pointer;">
                                <input type="checkbox" id="level1Space2" onchange="updatePatternWithSpaces('level1')">
                                <span>ê³µë°± 2ê°œ í—ˆìš©</span>
                            </label>
                        </div>
                    </div>

                    <div class="control-item">
                        <label for="level2Pattern">ë ˆë²¨ 2 íŒ¨í„´:</label>
                        <div class="control-item-row">
                            <select id="level2Pattern" style="flex: 1;">
                                <option value="">ì„ íƒ ì•ˆí•¨</option>
                                <option value="^\d+\.\d+\s+" selected>ìˆ«ì.ìˆ«ì (1.1, 1.2)</option>
                                <option value="^####\s+">#### (4ê°œ #)</option>
                                <option value="^###\s+">### (3ê°œ #)</option>
                                <option value="^##\s+">## (2ê°œ #)</option>
                                <option value="^#\s+"># (1ê°œ #)</option>
                                <option value="^\d+\)\s+">ìˆ«ì) (1), 2))</option>
                                <option value="^[a-z]\.\s+">ì†Œë¬¸ì. (a., b.)</option>
                                <option value="^[A-Z]\)\s+">ëŒ€ë¬¸ì) (A), B))</option>
                                <option value="^\(\d+\)\s+">ê´„í˜¸ìˆ«ì ((1), (2))</option>
                                <option value="custom">ì§ì ‘ ì…ë ¥</option>
                            </select>
                        </div>
                        <input type="text" id="level2Custom" placeholder="ì •ê·œì‹ ì…ë ¥" style="display:none;">
                        <div style="display: flex; gap: 10px; margin-top: 5px; font-size: 13px;">
                            <label style="display: flex; align-items: center; gap: 5px; cursor: pointer;">
                                <input type="checkbox" id="level2Space1" onchange="updatePatternWithSpaces('level2')">
                                <span>ê³µë°± 1ê°œ í—ˆìš©</span>
                            </label>
                            <label style="display: flex; align-items: center; gap: 5px; cursor: pointer;">
                                <input type="checkbox" id="level2Space2" onchange="updatePatternWithSpaces('level2')">
                                <span>ê³µë°± 2ê°œ í—ˆìš©</span>
                            </label>
                        </div>
                    </div>

                    <div class="control-item">
                        <label for="level3Pattern">ë ˆë²¨ 3 íŒ¨í„´:</label>
                        <div class="control-item-row">
                            <select id="level3Pattern" style="flex: 1;">
                                <option value="">ì„ íƒ ì•ˆí•¨</option>
                                <option value="^\s*-\s+" selected>- (ëŒ€ì‹œ)</option>
                                <option value="^\s*\*\s+">* (ë³„í‘œ)</option>
                                <option value="^\s*\+\s+">+ (í”ŒëŸ¬ìŠ¤)</option>
                                <option value="^####\s+">#### (4ê°œ #)</option>
                                <option value="^###\s+">### (3ê°œ #)</option>
                                <option value="^##\s+">## (2ê°œ #)</option>
                                <option value="^\d+\.\d+\.\d+\s+">ìˆ«ì.ìˆ«ì.ìˆ«ì (1.1.1)</option>
                                <option value="^[a-z]\)\s+">ì†Œë¬¸ì) (a), b))</option>
                                <option value="custom">ì§ì ‘ ì…ë ¥</option>
                            </select>
                        </div>
                        <input type="text" id="level3Custom" placeholder="ì •ê·œì‹ ì…ë ¥" style="display:none;">
                        <div style="display: flex; gap: 10px; margin-top: 5px; font-size: 13px;">
                            <label style="display: flex; align-items: center; gap: 5px; cursor: pointer;">
                                <input type="checkbox" id="level3Space1" onchange="updatePatternWithSpaces('level3')">
                                <span>ê³µë°± 1ê°œ í—ˆìš©</span>
                            </label>
                            <label style="display: flex; align-items: center; gap: 5px; cursor: pointer;">
                                <input type="checkbox" id="level3Space2" onchange="updatePatternWithSpaces('level3')">
                                <span>ê³µë°± 2ê°œ í—ˆìš©</span>
                            </label>
                        </div>
                    </div>

                    <div class="control-item">
                        <label for="level4Pattern">ë ˆë²¨ 4 íŒ¨í„´:</label>
                        <div class="control-item-row">
                            <select id="level4Pattern" style="flex: 1;">
                                <option value="" selected>ì„ íƒ ì•ˆí•¨</option>
                                <option value="^\s{4,}-\s+">ë“¤ì—¬ì“°ê¸° ëŒ€ì‹œ (    -)</option>
                                <option value="^\s{4,}\*\s+">ë“¤ì—¬ì“°ê¸° ë³„í‘œ (    *)</option>
                                <option value="^####\s+">#### (4ê°œ #)</option>
                                <option value="^###\s+">### (3ê°œ #)</option>
                                <option value="^\d+\.\d+\.\d+\.\d+\s+">ìˆ«ì4ë‹¨ê³„ (1.1.1.1)</option>
                                <option value="^[ê°€-í£]\.\s+">í•œê¸€. (ê°€., ë‚˜.)</option>
                                <option value="custom">ì§ì ‘ ì…ë ¥</option>
                            </select>
                        </div>
                        <input type="text" id="level4Custom" placeholder="ì •ê·œì‹ ì…ë ¥" style="display:none;">
                        <div style="display: flex; gap: 10px; margin-top: 5px; font-size: 13px;">
                            <label style="display: flex; align-items: center; gap: 5px; cursor: pointer;">
                                <input type="checkbox" id="level4Space1" onchange="updatePatternWithSpaces('level4')">
                                <span>ê³µë°± 1ê°œ í—ˆìš©</span>
                            </label>
                            <label style="display: flex; align-items: center; gap: 5px; cursor: pointer;">
                                <input type="checkbox" id="level4Space2" onchange="updatePatternWithSpaces('level4')">
                                <span>ê³µë°± 2ê°œ í—ˆìš©</span>
                            </label>
                        </div>
                    </div>

                    <div class="control-item">
                        <label for="level5Pattern">ë ˆë²¨ 5 íŒ¨í„´:</label>
                        <div class="control-item-row">
                            <select id="level5Pattern" style="flex: 1;">
                                <option value="" selected>ì„ íƒ ì•ˆí•¨</option>
                                <option value="^\s{8,}-\s+">ë“¤ì—¬ì“°ê¸°2 ëŒ€ì‹œ (        -)</option>
                                <option value="^#####\s+">##### (5ê°œ #)</option>
                                <option value="^####\s+">#### (4ê°œ #)</option>
                                <option value="^â—‹\s+">ì› ê¸°í˜¸ (â—‹)</option>
                                <option value="^â—\s+">ì±„ìš´ ì› (â—)</option>
                                <option value="custom">ì§ì ‘ ì…ë ¥</option>
                            </select>
                        </div>
                        <input type="text" id="level5Custom" placeholder="ì •ê·œì‹ ì…ë ¥" style="display:none;">
                        <div style="display: flex; gap: 10px; margin-top: 5px; font-size: 13px;">
                            <label style="display: flex; align-items: center; gap: 5px; cursor: pointer;">
                                <input type="checkbox" id="level5Space1" onchange="updatePatternWithSpaces('level5')">
                                <span>ê³µë°± 1ê°œ í—ˆìš©</span>
                            </label>
                            <label style="display: flex; align-items: center; gap: 5px; cursor: pointer;">
                                <input type="checkbox" id="level5Space2" onchange="updatePatternWithSpaces('level5')">
                                <span>ê³µë°± 2ê°œ í—ˆìš©</span>
                            </label>
                        </div>
                    </div>

                        </div>
                        </div>
                    </div>

                    <div class="collapsible-section">
                        <div class="collapsible-header" onclick="toggleCollapse(this)">
                            <span>ğŸ’¾ í”„ë¦¬ì…‹</span>
                            <span class="arrow">â–¼</span>
                        </div>
                        <div class="collapsible-content">

                    <div class="control-item">
                        <label>í”„ë¦¬ì…‹:</label>
                        <div class="control-item-row">
                            <select id="presetSelect" style="flex: 1;">
                                <option value="">í”„ë¦¬ì…‹ ì„ íƒ...</option>
                                <option value="default">ê¸°ë³¸ (###, 1.1, -)</option>
                                <option value="numbered">ìˆ«ì ì²´ê³„ (1., 1.1, 1.1.1)</option>
                                <option value="markdown">ë§ˆí¬ë‹¤ìš´ (#, ##, ###)</option>
                            </select>
                            <button class="btn" onclick="loadPreset()" style="padding: 8px 12px; font-size: 14px;">ë¶ˆëŸ¬ì˜¤ê¸°</button>
                        </div>
                        <button class="btn" onclick="savePreset()" style="width: 100%; margin-top: 5px; padding: 8px 12px; font-size: 14px; background: #ffc107; color: #333;">í˜„ì¬ ì„¤ì • ì €ì¥</button>
                    </div>

                        </div>
                    </div>
                </div>
                </div>

                <div id="guide-tab" class="tab-content">
                    <div style="background: #fff3cd; padding: 15px; border-radius: 8px; border-left: 4px solid #ffc107;">
                        <h4 style="color: #856404; margin-bottom: 10px;">ğŸ’¡ ì •ê·œì‹(Regex) ê¸°ë³¸ ê¸°í˜¸</h4>
                        <ul style="color: #856404; margin-left: 20px;">
                            <li><code>^</code> - ì¤„ì˜ ì‹œì‘</li>
                            <li><code>\s</code> - ê³µë°± ë¬¸ì (ìŠ¤í˜ì´ìŠ¤, íƒ­)</li>
                            <li><code>\s+</code> - í•˜ë‚˜ ì´ìƒì˜ ê³µë°±</li>
                            <li><code>\s*</code> - 0ê°œ ì´ìƒì˜ ê³µë°±</li>
                            <li><code>\d</code> - ìˆ«ì (0-9)</li>
                            <li><code>\d+</code> - í•˜ë‚˜ ì´ìƒì˜ ìˆ«ì</li>
                            <li><code>\.</code> - ì‹¤ì œ ë§ˆì¹¨í‘œ (ì´ìŠ¤ì¼€ì´í”„)</li>
                            <li><code>\*</code> - ì‹¤ì œ ë³„í‘œ (ì´ìŠ¤ì¼€ì´í”„) â†’ <code>\*\*</code> = ë³„í‘œ ë‘ ê°œ</li>
                            <li><code>[A-Z]</code> - ëŒ€ë¬¸ì ì•ŒíŒŒë²³</li>
                            <li><code>[a-z]</code> - ì†Œë¬¸ì ì•ŒíŒŒë²³</li>
                            <li><code>[ê°€-í£]</code> - í•œê¸€</li>
                            <li><code>\(</code>, <code>\)</code> - ê´„í˜¸ (ì´ìŠ¤ì¼€ì´í”„)</li>
                        </ul>
                    </div>

                    <div style="background: #e7f3ff; padding: 15px; border-radius: 8px; margin-top: 15px; border-left: 4px solid #667eea;">
                        <h4 style="color: #004085; margin-bottom: 10px;">ğŸ“ íŒ¨í„´ ì˜ˆì œ</h4>
                        <table style="width: 100%; color: #004085; font-size: 13px;">
                            <tr style="border-bottom: 1px solid #b8daff;">
                                <td style="padding: 8px; font-weight: 600;">ì •ê·œì‹</td>
                                <td style="padding: 8px; font-weight: 600;">ë§¤ì¹­ ì˜ˆì œ</td>
                            </tr>
                            <tr style="border-bottom: 1px solid #b8daff;">
                                <td style="padding: 8px;"><code>^###\s+</code></td>
                                <td style="padding: 8px;"><code>### ì œëª©</code></td>
                            </tr>
                            <tr style="border-bottom: 1px solid #b8daff;">
                                <td style="padding: 8px;"><code>^\d+\.\s+</code></td>
                                <td style="padding: 8px;"><code>1. í•­ëª©</code>, <code>2. í•­ëª©</code></td>
                            </tr>
                            <tr style="border-bottom: 1px solid #b8daff;">
                                <td style="padding: 8px;"><code>^\d+\.\d+\s+</code></td>
                                <td style="padding: 8px;"><code>1.1 ì†Œí•­ëª©</code></td>
                            </tr>
                            <tr style="border-bottom: 1px solid #b8daff;">
                                <td style="padding: 8px;"><code>^\s*-\s+</code></td>
                                <td style="padding: 8px;"><code>- í•­ëª©</code>, <code>    - í•­ëª©</code></td>
                            </tr>
                            <tr style="border-bottom: 1px solid #b8daff;">
                                <td style="padding: 8px;"><code>^\*\*\s*</code></td>
                                <td style="padding: 8px;"><code>** ì œëª©</code>, <code>**ì œëª©</code></td>
                            </tr>
                            <tr style="border-bottom: 1px solid #b8daff;">
                                <td style="padding: 8px;"><code>^ì œ\d+ì¥\s+</code></td>
                                <td style="padding: 8px;"><code>ì œ1ì¥ ì„œë¡ </code>, <code>ì œ2ì¥ ë³¸ë¡ </code></td>
                            </tr>
                            <tr style="border-bottom: 1px solid #b8daff;">
                                <td style="padding: 8px;"><code>^ì œ\d+ì ˆ\s+</code></td>
                                <td style="padding: 8px;"><code>ì œ1ì ˆ ê°œìš”</code>, <code>ì œ2ì ˆ ë°©ë²•</code></td>
                            </tr>
                            <tr style="border-bottom: 1px solid #b8daff;">
                                <td style="padding: 8px;"><code>^[A-Z]\.\s+</code></td>
                                <td style="padding: 8px;"><code>A. í•­ëª©</code>, <code>B. í•­ëª©</code></td>
                            </tr>
                            <tr style="border-bottom: 1px solid #b8daff;">
                                <td style="padding: 8px;"><code>^\(\d+\)\s+</code></td>
                                <td style="padding: 8px;"><code>(1) í•­ëª©</code>, <code>(2) í•­ëª©</code></td>
                            </tr>
                            <tr>
                                <td style="padding: 8px;"><code>^[ê°€-í£]\.\s+</code></td>
                                <td style="padding: 8px;"><code>ê°€. í•­ëª©</code>, <code>ë‚˜. í•­ëª©</code></td>
                            </tr>
                        </table>
                    </div>
                </div>
                </div>

                <div class="right-panel">
                    <div class="editor-container">
                <div class="editor-panel">
                    <h3>
                        <span>ì…ë ¥ (ì›ë³¸)</span>
                        <div style="display: flex; gap: 10px;">
                            <button class="btn btn-trim" onclick="trimLeadingSpaces()" style="padding: 8px 15px; font-size: 14px;">âœ‚ï¸ ê³µë°± ì œê±°</button>
                            <button class="btn btn-trim" onclick="removeCustomChars()" style="padding: 8px 15px; font-size: 14px;">ğŸ—‘ï¸ ë¬¸ì ì‚­ì œ</button>
                        </div>
                    </h3>
                    <textarea id="inputText" placeholder="ë³€í™˜í•  ë§ˆí¬ë‹¤ìš´ í…ìŠ¤íŠ¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”...

ì˜ˆì‹œ:
### 1. ë””ì§€í„¸íŠ¸ìœˆ ì—°ê³„ í†µí•© ì‹œí—˜ ì¸í”„ë¼ êµ¬ì¶•
1.1 ê·¹ì§€í™˜ê²½ ëª¨ì‚¬ í†µí•© ì‹œí—˜ì„¤ë¹„ êµ¬ì¶•
    - ì—°ë£Œì „ì§€ ë° ìˆ˜ì†Œì—”ì§„ í†µí•© ì‹œí—˜ ì¥ë¹„
    - ì „ë ¥ë³€í™˜ ì‹œí—˜ì„¤ë¹„"></textarea>
                </div>

                <div class="editor-panel">
                    <h3>
                        <span>ì¶œë ¥ (ë³€í™˜ ê²°ê³¼)</span>
                        <div style="display: flex; gap: 10px;">
                            <button class="btn" onclick="filterOutput()" style="padding: 8px 15px; font-size: 14px; background: #17a2b8; color: white;">ğŸ” ë ˆë²¨ í•„í„°ë§</button>
                            <button class="copy-icon" onclick="copyResult(event)" title="í´ë¦½ë³´ë“œì— ë³µì‚¬">
                                ğŸ“‹ ë³µì‚¬
                            </button>
                        </div>
                    </h3>
                    <textarea id="outputText" placeholder="ë³€í™˜ ê²°ê³¼ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤..." readonly></textarea>
                </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ê³µë°± í—ˆìš© ì˜µì…˜ì— ë”°ë¼ íŒ¨í„´ ì—…ë°ì´íŠ¸
        function updatePatternWithSpaces(level) {
            const selectId = `${level}Pattern`;
            const space1Id = `${level}Space1`;
            const space2Id = `${level}Space2`;

            const select = document.getElementById(selectId);
            const space1 = document.getElementById(space1Id).checked;
            const space2 = document.getElementById(space2Id).checked;

            // custom ì˜µì…˜ì´ê±°ë‚˜ ì„ íƒ ì•ˆí•¨ì´ë©´ ì•„ë¬´ê²ƒë„ í•˜ì§€ ì•ŠìŒ
            if (select.value === 'custom' || select.value === '') {
                return;
            }

            // ì›ë³¸ íŒ¨í„´ ê°€ì ¸ì˜¤ê¸° (ì„ íƒëœ optionì˜ value)
            const selectedOption = select.options[select.selectedIndex];
            let basePattern = selectedOption.value;

            // ê³µë°± ì˜µì…˜ì— ë”°ë¼ íŒ¨í„´ ìˆ˜ì •
            if (space1 && space2) {
                // ê³µë°± 1ê°œ ë˜ëŠ” 2ê°œ í—ˆìš©: ^ ë’¤ì— \s{0,2} ì¶”ê°€
                basePattern = basePattern.replace(/^\^/, '^\\s{0,2}');
            } else if (space1) {
                // ê³µë°± 1ê°œë§Œ í—ˆìš©: ^ ë’¤ì— \s? ì¶”ê°€
                basePattern = basePattern.replace(/^\^/, '^\\s?');
            } else if (space2) {
                // ê³µë°± 2ê°œë§Œ í—ˆìš©: ^ ë’¤ì— \s{0,2} ì¶”ê°€
                basePattern = basePattern.replace(/^\^/, '^\\s{0,2}');
            }

            // ì—…ë°ì´íŠ¸ëœ íŒ¨í„´ì„ selectì˜ valueë¡œ ì„¤ì •
            // (ì‹¤ì œë¡œëŠ” option valueë¥¼ ìˆ˜ì •í•˜ì§€ ì•Šê³ , ë³€í™˜ ì‹œ ì´ ê°’ì„ ì‚¬ìš©)
            select.setAttribute('data-modified-pattern', basePattern);
        }

        // ì ‘ê¸°/í¼ì¹˜ê¸° í•¨ìˆ˜
        function toggleCollapse(header) {
            const content = header.nextElementSibling;
            header.classList.toggle('collapsed');
            content.classList.toggle('collapsed');
        }

        // íƒ­ ì „í™˜ í•¨ìˆ˜
        function switchTab(tabName) {
            // ëª¨ë“  íƒ­ ë²„íŠ¼ ë¹„í™œì„±í™”
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });

            // ëª¨ë“  íƒ­ ì»¨í…ì¸  ìˆ¨ê¹€
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });

            // ì„ íƒëœ íƒ­ í™œì„±í™”
            event.target.classList.add('active');
            document.getElementById(tabName + '-tab').classList.add('active');
        }

        // í”„ë¦¬ì…‹ ì •ì˜
        const presets = {
            default: {
                level1: '^###\\s+',
                level2: '^\\d+\\.\\d+\\s+',
                level3: '^\\s*-\\s+',
                level4: '',
                level5: '',
                outputLevel: 3
            },
            numbered: {
                level1: '^\\d+\\.\\s+',
                level2: '^\\d+\\.\\d+\\s+',
                level3: '^\\d+\\.\\d+\\.\\d+\\s+',
                level4: '^\\d+\\.\\d+\\.\\d+\\.\\d+\\s+',
                level5: '',
                outputLevel: 1
            },
            markdown: {
                level1: '^#\\s+',
                level2: '^##\\s+',
                level3: '^###\\s+',
                level4: '^####\\s+',
                level5: '^#####\\s+',
                outputLevel: 1
            }
        };

        // íŒ¨í„´ ì„ íƒ ë³€ê²½ ì‹œ ì»¤ìŠ¤í…€ ì…ë ¥ í•„ë“œ í‘œì‹œ/ìˆ¨ê¹€
        function setupPatternSelects() {
            ['level1Pattern', 'level2Pattern', 'level3Pattern', 'level4Pattern', 'level5Pattern'].forEach(id => {
                const select = document.getElementById(id);
                const customInput = document.getElementById(id.replace('Pattern', 'Custom'));

                select.addEventListener('change', function() {
                    if (this.value === 'custom') {
                        customInput.style.display = 'block';
                    } else {
                        customInput.style.display = 'none';
                    }
                });
            });
        }

        function trimLeadingSpaces() {
            const inputText = document.getElementById('inputText');
            const content = inputText.value;

            if (!content.trim()) {
                alert('ê³µë°±ì„ ì œê±°í•  ë‚´ìš©ì´ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }

            // ê° ë¼ì¸ì˜ ì•ë¶€ë¶„ ê³µë°± ì œê±°
            const lines = content.split('\n');
            const trimmedLines = lines.map(line => line.trimStart());
            const result = trimmedLines.join('\n');

            inputText.value = result;
            console.log('[ê³µë°± ì œê±° ì™„ë£Œ] ê° ë¼ì¸ì˜ ì•ë¶€ë¶„ ê³µë°± ì œê±°ë¨');
        }

        function removeCustomChars() {
            const inputText = document.getElementById('inputText');
            const content = inputText.value;

            if (!content.trim()) {
                alert('ë‚´ìš©ì´ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }

            // ì‚¬ìš©ìì—ê²Œ ì‚­ì œí•  ë¬¸ì ì…ë ¥ ë°›ê¸°
            const charsToRemove = prompt('ì‚­ì œí•  ë¬¸ìë¥¼ ì…ë ¥í•˜ì„¸ìš” (ì—¬ëŸ¬ ë¬¸ì ì…ë ¥ ê°€ëŠ¥):\nì˜ˆ: ()ê´„í˜¸, [], ì‰¼í‘œ, ë“±', '');

            if (charsToRemove === null) {
                // ì·¨ì†Œ ë²„íŠ¼ í´ë¦­
                return;
            }

            if (charsToRemove === '') {
                alert('ì‚­ì œí•  ë¬¸ìë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }

            // íŠ¹ìˆ˜ë¬¸ì ì´ìŠ¤ì¼€ì´í”„ ì²˜ë¦¬
            const escapedChars = charsToRemove.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
            const regex = new RegExp(`[${escapedChars}]`, 'g');

            // ë¬¸ì ì‚­ì œ
            const result = content.replace(regex, '');

            inputText.value = result;
            console.log(`[ë¬¸ì ì‚­ì œ ì™„ë£Œ] ì‚­ì œëœ ë¬¸ì: "${charsToRemove}"`);
            alert(`ì‚­ì œ ì™„ë£Œ!\nì‚­ì œëœ ë¬¸ì: "${charsToRemove}"`);
        }

        function loadFile(input) {
            const file = input.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = function(e) {
                document.getElementById('inputText').value = e.target.result;
                document.getElementById('fileName').textContent = 'ğŸ“„ ' + file.name;
            };
            reader.readAsText(file, 'UTF-8');
        }

        function getPatternValue(selectId, customId) {
            const select = document.getElementById(selectId);
            if (select.value === 'custom') {
                return document.getElementById(customId).value;
            }
            // ê³µë°± ì˜µì…˜ì´ ì ìš©ëœ íŒ¨í„´ì´ ìˆìœ¼ë©´ ê·¸ê²ƒì„ ì‚¬ìš©
            const modifiedPattern = select.getAttribute('data-modified-pattern');
            if (modifiedPattern) {
                return modifiedPattern;
            }
            return select.value;
        }

        function loadPreset() {
            const presetName = document.getElementById('presetSelect').value;
            if (!presetName) {
                alert('í”„ë¦¬ì…‹ì„ ì„ íƒí•´ì£¼ì„¸ìš”.');
                return;
            }

            // ê¸°ë³¸ í”„ë¦¬ì…‹ ë˜ëŠ” ì‚¬ìš©ì ì •ì˜ í”„ë¦¬ì…‹
            let preset = presets[presetName];

            // ì‚¬ìš©ì ì •ì˜ í”„ë¦¬ì…‹ì¸ ê²½ìš° localStorageì—ì„œ ë¶ˆëŸ¬ì˜¤ê¸°
            if (!preset && presetName.startsWith('custom_')) {
                const savedPreset = localStorage.getItem(`preset_${presetName.substring(7)}`);
                if (savedPreset) {
                    preset = JSON.parse(savedPreset);
                }
            }

            if (preset) {
                document.getElementById('level1Pattern').value = preset.level1;
                document.getElementById('level2Pattern').value = preset.level2;
                document.getElementById('level3Pattern').value = preset.level3;
                document.getElementById('level4Pattern').value = preset.level4;
                document.getElementById('level5Pattern').value = preset.level5;
                document.getElementById('outputLevel').value = preset.outputLevel;

                // ê³µë°± í—ˆìš© ì„¤ì • ë¶ˆëŸ¬ì˜¤ê¸°
                if (preset.level1Space1 !== undefined) {
                    document.getElementById('level1Space1').checked = preset.level1Space1 || false;
                    document.getElementById('level1Space2').checked = preset.level1Space2 || false;
                    document.getElementById('level2Space1').checked = preset.level2Space1 || false;
                    document.getElementById('level2Space2').checked = preset.level2Space2 || false;
                    document.getElementById('level3Space1').checked = preset.level3Space1 || false;
                    document.getElementById('level3Space2').checked = preset.level3Space2 || false;
                    document.getElementById('level4Space1').checked = preset.level4Space1 || false;
                    document.getElementById('level4Space2').checked = preset.level4Space2 || false;
                    document.getElementById('level5Space1').checked = preset.level5Space1 || false;
                    document.getElementById('level5Space2').checked = preset.level5Space2 || false;

                    // ê³µë°± ì„¤ì • ì ìš© í›„ íŒ¨í„´ ì—…ë°ì´íŠ¸
                    updatePatternWithSpaces('level1');
                    updatePatternWithSpaces('level2');
                    updatePatternWithSpaces('level3');
                    updatePatternWithSpaces('level4');
                    updatePatternWithSpaces('level5');
                }

                alert(`"${presetName}" í”„ë¦¬ì…‹ì„ ë¶ˆëŸ¬ì™”ìŠµë‹ˆë‹¤.`);
            }
        }

        function savePreset() {
            const name = prompt('í”„ë¦¬ì…‹ ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”:');
            if (!name) return;

            const preset = {
                level1: getPatternValue('level1Pattern', 'level1Custom'),
                level2: getPatternValue('level2Pattern', 'level2Custom'),
                level3: getPatternValue('level3Pattern', 'level3Custom'),
                level4: getPatternValue('level4Pattern', 'level4Custom'),
                level5: getPatternValue('level5Pattern', 'level5Custom'),
                outputLevel: parseInt(document.getElementById('outputLevel').value),
                // ê³µë°± í—ˆìš© ì„¤ì • ì €ì¥
                level1Space1: document.getElementById('level1Space1').checked,
                level1Space2: document.getElementById('level1Space2').checked,
                level2Space1: document.getElementById('level2Space1').checked,
                level2Space2: document.getElementById('level2Space2').checked,
                level3Space1: document.getElementById('level3Space1').checked,
                level3Space2: document.getElementById('level3Space2').checked,
                level4Space1: document.getElementById('level4Space1').checked,
                level4Space2: document.getElementById('level4Space2').checked,
                level5Space1: document.getElementById('level5Space1').checked,
                level5Space2: document.getElementById('level5Space2').checked
            };

            localStorage.setItem(`preset_${name}`, JSON.stringify(preset));

            // í”„ë¦¬ì…‹ ëª©ë¡ì— ì¶”ê°€
            const select = document.getElementById('presetSelect');
            const option = document.createElement('option');
            option.value = `custom_${name}`;
            option.textContent = `${name} (ì‚¬ìš©ì ì •ì˜)`;
            select.appendChild(option);

            alert(`"${name}" í”„ë¦¬ì…‹ì´ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.`);
        }

        async function convertText() {
            const content = document.getElementById('inputText').value;
            const outputLevel = parseInt(document.getElementById('outputLevel').value);
            const suffix = document.getElementById('suffix').value;
            const removeChars = document.getElementById('removeChars').value;

            // íŒ¨í„´ ìˆ˜ì§‘
            const level1Pattern = getPatternValue('level1Pattern', 'level1Custom');
            const level2Pattern = getPatternValue('level2Pattern', 'level2Custom');
            const level3Pattern = getPatternValue('level3Pattern', 'level3Custom');
            const level4Pattern = getPatternValue('level4Pattern', 'level4Custom');
            const level5Pattern = getPatternValue('level5Pattern', 'level5Custom');

            // ë””ë²„ê¹… ë¡œê·¸
            console.log('ë³€í™˜ ìš”ì²­:', {
                output_level: outputLevel,
                level1_pattern: level1Pattern,
                level2_pattern: level2Pattern,
                level3_pattern: level3Pattern,
                level4_pattern: level4Pattern,
                level5_pattern: level5Pattern,
                suffix: suffix,
                remove_chars: removeChars
            });

            if (!content.trim()) {
                alert('ë³€í™˜í•  ë‚´ìš©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }

            try {
                const response = await fetch('/convert', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        content: content,
                        output_level: outputLevel,
                        level1_pattern: level1Pattern,
                        level2_pattern: level2Pattern,
                        level3_pattern: level3Pattern,
                        level4_pattern: level4Pattern,
                        level5_pattern: level5Pattern,
                        suffix: suffix,
                        remove_chars: removeChars
                    })
                });

                const data = await response.json();
                console.log('ì„œë²„ ì‘ë‹µ:', data);

                if (data.success) {
                    document.getElementById('outputText').value = data.result;
                } else {
                    alert('ì˜¤ë¥˜: ' + data.error);
                }
            } catch (error) {
                console.error('ë³€í™˜ ì˜¤ë¥˜:', error);
                alert('ë³€í™˜ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + error);
            }
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸°í™”
        document.addEventListener('DOMContentLoaded', setupPatternSelects);

        async function downloadFile() {
            const content = document.getElementById('outputText').value;

            if (!content.trim()) {
                alert('ë‹¤ìš´ë¡œë“œí•  ë‚´ìš©ì´ ì—†ìŠµë‹ˆë‹¤. ë¨¼ì € ë³€í™˜ì„ ì‹¤í–‰í•´ì£¼ì„¸ìš”.');
                return;
            }

            try {
                const response = await fetch('/download', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        content: content,
                        filename: 'converted.md'
                    })
                });

                const blob = await response.blob();
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = 'converted.md';
                document.body.appendChild(a);
                a.click();
                window.URL.revokeObjectURL(url);
                document.body.removeChild(a);
            } catch (error) {
                alert('ë‹¤ìš´ë¡œë“œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + error);
            }
        }

        function copyResult(event) {
            const content = document.getElementById('outputText').value;

            if (!content.trim()) {
                alert('ë³µì‚¬í•  ë‚´ìš©ì´ ì—†ìŠµë‹ˆë‹¤. ë¨¼ì € ë³€í™˜ì„ ì‹¤í–‰í•´ì£¼ì„¸ìš”.');
                return;
            }

            // í´ë¦½ë³´ë“œì— ë³µì‚¬
            navigator.clipboard.writeText(content).then(function() {
                // ë²„íŠ¼ ì°¾ê¸° (ì´ë²¤íŠ¸ íƒ€ê²Ÿì´ spanì¼ ìˆ˜ë„ ìˆìœ¼ë¯€ë¡œ)
                const btn = event.target.closest('.copy-icon');
                const originalHTML = btn.innerHTML;
                btn.innerHTML = 'âœ“ ì™„ë£Œ!';
                btn.classList.add('success');

                setTimeout(function() {
                    btn.innerHTML = originalHTML;
                    btn.classList.remove('success');
                }, 2000);
            }).catch(function(err) {
                alert('ë³µì‚¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + err);
            });
        }

        function filterOutput() {
            const outputText = document.getElementById('outputText').value;
            if (!outputText.trim()) {
                alert('í•„í„°ë§í•  ë‚´ìš©ì´ ì—†ìŠµë‹ˆë‹¤. ë¨¼ì € ë³€í™˜ì„ ì‹¤í–‰í•´ì£¼ì„¸ìš”.');
                return;
            }

            // ì²´í¬ëœ ì œì™¸ ë ˆë²¨ ìˆ˜ì§‘
            const excludeLevels = [];
            for (let i = 1; i <= 6; i++) {
                if (document.getElementById(`excludeLevel${i}`).checked) {
                    excludeLevels.push(i);
                }
            }

            if (excludeLevels.length === 0) {
                alert('ì œì™¸í•  ë ˆë²¨ì„ ì„ íƒí•´ì£¼ì„¸ìš”.');
                return;
            }

            // ë¼ì¸ë³„ë¡œ í•„í„°ë§
            const lines = outputText.split('\n');
            const filtered = lines.filter(line => {
                // ë§ˆí¬ë‹¤ìš´ í—¤ë”© ë ˆë²¨ ê°ì§€ (ì¤„ ì‹œì‘ì˜ # ê°œìˆ˜)
                const match = line.trim().match(/^(#+)/);
                if (match) {
                    const level = match[1].length;
                    return !excludeLevels.includes(level);
                }
                // í—¤ë”©ì´ ì•„ë‹Œ ì¤„ì€ ìœ ì§€
                return true;
            });

            document.getElementById('outputText').value = filtered.join('\n');
            console.log(`[í•„í„°ë§ ì™„ë£Œ] ì›ë³¸ ${lines.length}ì¤„ â†’ í•„í„°ë§ í›„ ${filtered.length}ì¤„`);
        }

        function clearAll() {
            if (confirm('ì…ë ¥ê³¼ ì¶œë ¥ì„ ëª¨ë‘ ì´ˆê¸°í™”í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                document.getElementById('inputText').value = '';
                document.getElementById('outputText').value = '';
                document.getElementById('fileName').textContent = '';
                document.getElementById('fileInput').value = '';
                document.getElementById('suffix').value = '';
                document.getElementById('removeChars').value = '';
                document.getElementById('excludeLevel1').checked = false;
                document.getElementById('excludeLevel2').checked = false;
                document.getElementById('excludeLevel3').checked = false;
                document.getElementById('excludeLevel4').checked = false;
                document.getElementById('excludeLevel5').checked = false;
                document.getElementById('excludeLevel6').checked = false;
            }
        }

        // Enter í‚¤ë¡œ ë³€í™˜ ì‹¤í–‰
        document.getElementById('inputText').addEventListener('keydown', function(e) {
            if (e.ctrlKey && e.key === 'Enter') {
                convertText();
            }
        });
    </script>
</body>
</html>
